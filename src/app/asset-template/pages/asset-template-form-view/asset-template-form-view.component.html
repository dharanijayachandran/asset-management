<!--  Role forms view starts here -->
<!-- <div class="row">
  <div class="col-md-12">
    <h1 i18n="@@Assettemplate" class="page-header">
      {{addEditText}} Asset Templates
    </h1>
  </div>
</div> -->
<div class="row margin_0px rowBox">
  <div class="col-md-12 padding_0px">
    <div class="padding_Form">
      <form [formGroup]="AssetTemplateForm" novalidate (ngSubmit)="previewMode()">
        <legend i18n="Header|Asset Template Details@@assetTemplateDetails" class="m-b-15"> Asset Template Details
        </legend>
        <div class="formBodyCustom1" id="">
          <div class="form-group-custom1">
            <div class="m-form__group row">
              <div class="col-lg-6">
                <label i18n="Name|Name@@name*" class="">Name<span class="text-danger">*</span></label>
                <div class="form-group">
                  <div [ngClass]="{'has-error': ((AssetTemplateForm.get('name').touched ||
                              AssetTemplateForm.get('name').dirty) &&
                              AssetTemplateForm.get('name').errors)}">
                    <input (keyup)="onKey($event)" type="text" id="tenantFullName" formControlName="name"
                      class="form-control m-input"
                      i18n-placeholder="Asset Template Name placeholder|Enter Asset Template Name@@assetTemplateName.placeholder"
                      placeholder="Enter Asset Template Name">
                    <span class="help-block" *ngIf="((AssetTemplateForm.get('name').touched ||
                                        AssetTemplateForm.get('name').dirty) &&
                                        AssetTemplateForm.get('name').errors)">
                      <span i18n="Message|Please enter Asset Template Name@@assetTemplateName.message"
                        *ngIf="(AssetTemplateForm.get('name').errors.required || AssetTemplateForm.get('name').errors.whitespace)">
                        Please enter Asset Template Name
                      </span>
                      <span i18n="Message|Please enter valid Characters@@assetTemplateName.message3"
                        *ngIf="AssetTemplateForm.get('name').errors.pattern">
                        Please enter valid Characters
                      </span>
                      <span>
                      </span>
                    </span>
                  </div>
                </div>

                <label i18n="Asset Category|Asset Category@@assetCategory*" class="">Asset Category<span
                    class="text-danger">*</span></label>
                <div class="form-group">
                  <div [ngClass]="{'has-error': ((AssetTemplateForm.get('assetCategoryId').touched ||
                        AssetTemplateForm.get('assetCategoryId').dirty) &&
                        AssetTemplateForm.get('assetCategoryId').errors)}">
                    <!-- <select id="assetCategoryId" (change)="assetCategoryChange($event)"
                      formControlName="assetCategoryId" class="form-control m-input" required>
                      <option i18n="Option|Select@@select" [ngValue]="null">--Select--</option>
                      <option *ngFor="let assetCategoryObj of assetCategory | orderByAlphabetical:'name'"
                        [value]=assetCategoryObj.id>{{assetCategoryObj.name}}</option>
                    </select> -->
                    <ejs-dropdownlist id='ddlelement' #ddlelement class="form-control p-0" [value]='assetCategoryId'
                    name="assetCategoryId" formControlName="assetCategoryId" [dataSource]='assetCategory'
                    [placeholder]='assetCategoryWaterMark' [fields]='assetCategoryFields' [popupHeight]='height'
                    [sortOrder]="sortDropDown" (filtering)='onFilteringAssetCategory($event)'
                    [filterBarPlaceholder]="filterPlaceholder" [allowFiltering]='true'
                    (change)='assetCategoryChange($event)' [locale]='locale'></ejs-dropdownlist>
                    <span class="help-block" *ngIf="((AssetTemplateForm.get('assetCategoryId').touched ||
                                      AssetTemplateForm.get('assetCategoryId').dirty) &&
                                      AssetTemplateForm.get('assetCategoryId').errors)">
                      <span i18n="Message|Please select Asset Category@@assetCategory.message"
                        *ngIf="AssetTemplateForm.get('assetCategoryId').errors.required">
                        Please select Asset Category
                      </span>
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-lg-6">
                <label i18n="Description|Description@@description" class="">Description</label>
                <div class="form-group">
                  <textarea type="text" id="description" formControlName="description"
                    class="form-control m-input textAreaHeight"
                    i18n-placeholder="Description placeholder|Enter Description@@description.placeholder"
                    placeholder="Enter Description"></textarea>
                </div>
              </div>

            </div>
            <div class="m-form__group row">
              <div class="col-lg-6">
                <label i18n="Asset Type|Asset Type@@assetType" class="">Asset Type</label>
                <div class="form-group">
                  <!-- <select id="assetTypeId" (change)="assetTypeChange($event)" formControlName="typeId"
                    class="form-control m-input">
                    <option i18n="Option|Select@@select" [ngValue]="null">--Select--</option>
                    <option *ngFor="let assetType of assetTypeByCategorys|orderByAlphabetical:'name'"
                      [value]=assetType.id>{{assetType.name}}</option>
                  </select> -->
                  <ejs-dropdownlist id='ddlelement' #ddlelement class="form-control p-0" [value]='typeId'
                  name="typeId" formControlName="typeId" [dataSource]='assetTypeByCategorys'
                  [placeholder]='assetTypeWaterMark' [fields]='assetTypeFields' [popupHeight]='height'
                  [sortOrder]="sortDropDown" (filtering)='onFilteringAssetType($event)'
                  [filterBarPlaceholder]="filterPlaceholder" [allowFiltering]='true'
                  (change)='assetTypeChange($event)' [locale]='locale'></ejs-dropdownlist>
                </div>
              </div>
              <div class="col-lg-6">
                <label i18n="Gateway Template|Gateway Template@@gatewayTemplate" class="">Gateway Template</label>
                <div class="form-group">
                  <!-- <select  formControlName="gateWayTemplateId" (change)="gatewayTemplateChange($event)" class="form-control m-input">
                      <option i18n="Option|Select@@select" [ngValue]="null">--Select--</option>
                      <option *ngFor="let gatewayTemplateObj of gatewayTemplate" [value]=gatewayTemplateObj.id>{{gatewayTemplateObj.name}}</option>
                    </select> -->
                  <ejs-dropdownlist id='ddlelement' #ddlelement class="form-control p-0" [value]='gateWayTemplateId'
                    name="gateWayTemplateId" formControlName="gateWayTemplateId" [dataSource]='gatewayTemplate'
                    [placeholder]='gatewayTemplateWaterMark' [fields]='gatewayTemplateFields' [popupHeight]='height'
                    [sortOrder]="sortDropDown" (filtering)='onFilteringGatewayTemplates($event)'
                    [filterBarPlaceholder]="filterPlaceholder" [allowFiltering]='true'
                    (change)='gatewayTemplateChange($event)' [locale]='locale'></ejs-dropdownlist>

                </div>
              </div>

            </div>
            <div class="m-form__group row">
              <div class="col-lg-6">
                <label i18n="IS GPS Tracking Enable|IS GPS Tracking Enable@isGPSTracingEnabled">GPS
                  Tracking Enabled
                </label>
                <div class="form-group">
                  <mat-checkbox #checkbox="matCheckbox" formControlName="isGPSTrackingEnabled"
                    (click)="isGPSTracingEnabledCheckBox(checkbox)" color='primary' [checked]='isGPSTracingEnabled'>
                  </mat-checkbox>
                </div>
              </div>
              <div class="col-lg-6">
                <label i18n="Geospatial Object Type|Geospatial Object Type@@geospatialObjectType" class="">Geospatial
                  Object Type</label>
                <div class="form-group">
                  <select [attr.disabled]="enableGeospatialObjectType ? true : null"
                    formControlName="geospatialObjectType"
                    class="form-control m-input">
                    <option *ngFor="let geospatialObjectType of geospatialObjectTypes|orderByAlphabetical:'name'"
                      [value]=geospatialObjectType.id>{{geospatialObjectType.name}}</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="m-form__group row">
              <div class="col-lg-6">
                <label i18n="Rt Data Sharing Enabled|Rt Data Sharing Enabled@rtDataSharingEnabled">Real Time Data
                  Sharing Enabled
                </label>
                <div class="form-group">
                  <mat-checkbox formControlName="isRtDataSharingEnabled" (change)="RtDataSharingENableChange($event)" color='primary'>
                  </mat-checkbox>
                </div>
              </div>
              <div class="col-lg-6">
                <label i18n="Rt Data Sharing Topic|Rt Data Sharing Topic@@rtDataSharingTopic*" class="">Real Time Data Sharing
                  Topic</label>
                <div class="form-group">
                  <div [ngClass]="{'has-error': ((AssetTemplateForm.get('rtDataSharingTopic').touched ||
                    AssetTemplateForm.get('rtDataSharingTopic').dirty) &&
                    AssetTemplateForm.get('rtDataSharingTopic').errors)}">
                    <ejs-dropdownlist id='ddlelement' [readonly]="!AssetTemplateForm.get('isRtDataSharingEnabled').value"
                      #ddlelement class="form-control p-0" [value]='rtDataSharingTopic' name="rtDataSharingTopic"
                      formControlName="rtDataSharingTopic" [dataSource]='rtDataSharingTopics'
                      [placeholder]='rtDataSharingTopicWaterMark' [fields]='rtDataSharingTopicFields'
                      [popupHeight]='height' [sortOrder]="sortDropDown"
                      (filtering)='onFilteringRtDataSharingTopic($event)' [filterBarPlaceholder]="filterPlaceholder"
                      [allowFiltering]='true' [locale]='locale'></ejs-dropdownlist>
                    <span class="help-block" *ngIf="((AssetTemplateForm.get('rtDataSharingTopic').touched ||
                        AssetTemplateForm.get('rtDataSharingTopic').dirty) &&
                        AssetTemplateForm.get('rtDataSharingTopic').errors)">
                      <span i18n="Message|Please enter Real Time Data Sharing Topic@@assetName.message3"
                        *ngIf="AssetTemplateForm.get('rtDataSharingTopic').errors.required">
                        Please select Real Time Data Sharing Topic
                      </span>
                      <span>
                      </span>
                    </span>
                  </div>
                </div>
              </div>
            </div>
            <div class="m-form__group row">
              <div class="col-lg-6">
                  <label i18n="Time Zone|Time Zone@@timeZoneId" class="">Time Zone</label>
                  <span class="text-danger">*</span>
                  <div class="form-group">
                    <div >
                      <ejs-dropdownlist id='ddlelement' #ddlelement class="form-control p-0"
                      name="timeZoneId" formControlName="timeZoneId" [dataSource]='timeZoneData'
                      [placeholder]='watermark' [fields]='fields' [popupHeight]='height' [sortOrder]="sortDropDown"
                      [filterBarPlaceholder]="filterPlaceholder" [allowFiltering]='true'
                      (change)='timeZoneOnChange($event)' [locale]='locale' ></ejs-dropdownlist> 
                    </div>
                </div>
              </div>
              <div class="col-lg-6">
                <label i18n="Status|Status@@status">Status
                  <!-- <span class="text-danger">*</span> -->
                </label>
                <div class="form-group">
                  <mat-radio-group formControlName="status">
                    <mat-radio-button value="Active" i18n="Radio button|Active@@active" style="margin-right: 20px;">
                      Active
                    </mat-radio-button>
                    <mat-radio-button value="In_Active" i18n="Radio button|InActive@@inActive">In-Active
                    </mat-radio-button>
                  </mat-radio-group>
                </div>
              </div>
            </div>
            <div class="container mat-elevation-z8 panel panel-inverse mb-4">
              <app-panel-user class="panel-header"
                i18n-name="Panel header|List of Asset Parameters@@listOfAssetParamters" name="List of Asset Parameters"
                #panelHeader (refreshTableList)="refreshTableListFunction()">
                <!-- Add New button -->
                <a addNewButton i18n="Add button|Click to Add Paramater@@addParameter" (click)="addRow()"
                  matTooltip="Click to Add Paramater" class="btn btn-xs btn-icon btn-circle btn-warning">
                  <i class="fa fa-plus"></i>
                </a>

                <div class="position-relative">
                  <div class="table-responsive ps position-relative" appScrollbarDirective
                    *ngIf="dataSource && dataSource.data.length">
                    <table mat-table [dataSource]="dataSource" class="table table-striped table-bordered"
                      formArrayName="assetParams">
                      <!-- Row definitions -->
                      <tr mat-header-row *matHeaderRowDef="displayedColumns;sticky: true"></tr>
                      <tr mat-row *matRowDef="let element; let i = index; columns: displayedColumns;"></tr>
                      <!-- Column definitions -->
                      <!-- <ng-container matColumnDef="id">
                        <th i18n="@@SNo" mat-header-cell *matHeaderCellDef style="display: none!important">S.No.</th>
                        <td mat-cell *matCellDef="let element; let i = index;" style="display: none">
                          {{ (i+1)}}</td>
                      </ng-container> -->

                      <ng-container matColumnDef="name">
                        <th i18n="Table|Name@@name" mat-header-cell *matHeaderCellDef> Name<span
                            class="text-danger">*</span> </th>
                        <td mat-cell *matCellDef="let element;let i = index; " [formGroupName]="i">
                          <div [ngClass]="{'has-error': ((AssetTemplateForm.get('assetParams')['controls'][i].get('name').touched ||
                     AssetTemplateForm.get('assetParams')['controls'][i].get('name').dirty) &&
                     AssetTemplateForm.get('assetParams')['controls'][i].get('name').errors)}">
                            <input type="text" formControlName="name"
                              i18n-placeholder="Parameter Name placeholder|Enter Parameter Name@@parameterName"
                              placeholder="Enter Parameter Name" class="form-control">
                            <span class="help-block" *ngIf="((AssetTemplateForm.get('assetParams')['controls'][i].get('name').touched ||
                         AssetTemplateForm.get('assetParams')['controls'][i].get('name').dirty) &&
                         AssetTemplateForm.get('assetParams')['controls'][i].get('name').errors)"><span
                                i18n="Message|Name is required@@assetParams"
                                *ngIf="AssetTemplateForm.get('assetParams')['controls'][i].get('name').errors.required">
                                Name is required
                              </span>
                            </span>
                          </div>
                        </td>
                      </ng-container>

                      <ng-container matColumnDef="description">
                        <th i18n="Table|Description@@description" mat-header-cell *matHeaderCellDef> Description</th>
                        <td mat-cell *matCellDef="let element;let i = index; " [formGroupName]="i">
                          <input type="text" formControlName="description"
                            i18n-placeholder="Description placeholder|Enter Description@@description.placeholder"
                            placeholder="Enter Description" class="form-control">
                        </td>
                      </ng-container>

                      <ng-container matColumnDef="value">
                        <th i18n="Table|Value@@value" mat-header-cell *matHeaderCellDef> Value </th>
                        <td mat-cell *matCellDef="let element;let i = index; " [formGroupName]="i">
                          <input type="text" formControlName="value"
                            i18n-placeholder="Value placeholder|Enter Value@@value.placeholder"
                            placeholder="Enter Value" class="form-control">
                        </td>
                      </ng-container>

                      <ng-container matColumnDef="engUnit">
                        <th i18n="Table|Engineering Unit@@engUnit" mat-header-cell *matHeaderCellDef> Eng Unit</th>
                        <td mat-cell *matCellDef="let element;let i = index; " [formGroupName]="i">
                          <select formControlName="engUnitId" class="form-control m-input">
                            <option i18n="Option|Select@@select" [ngValue]="null">--Select--</option>
                            <option *ngFor="let engUnit of engUnits" [ngValue]="engUnit.id">
                              {{engUnit.name}}</option>
                          </select>
                        </td>
                      </ng-container>
                      <ng-container matColumnDef="action">
                        <th i18n="Table|Action@@action" mat-header-cell *matHeaderCellDef> Action</th>
                        <td mat-cell *matCellDef="let element;let i = index; " [formGroupName]="i">
                          <a class="" (click)="deleteAssetParameter(element, i)">
                            <i class="fas fa-md fa-fw m-r-10 fa-trash-alt" alt="delete"
                              i18n-matTooltip="Delete button|Click to Delete tooltip@@clickToDelete"
                              matTooltip="Click to Delete"></i>
                          </a>
                        </td>
                      </ng-container>

                    </table>
                  </div>
                  <h3 i18n="No records found text|No records found@@noRecordsFound"
                    *ngIf="dataSource && !dataSource.data.length" class="text-center noRecordsFound">
                    No records found!
                  </h3>
                </div>

              </app-panel-user>



            </div>
          </div>


          <div class="path finalLine"></div>
          <div class="row" style="    text-align: right;padding: 23px 0;">
            <div class="col-md-12">
              <a (click)="cancelForm($event)">
                <button type="button" id="cancelForm" class="btn btn-default text-center cancelActionButton"
                  i18n="Cancel button|Cancel@@cancel"> Cancel
                </button>
              </a>
              &nbsp;
              <button type="button" class="btn btn-secondary text-center resetActionButton"
                [disabled]="!AssetTemplateForm.dirty && AssetTemplateForm.pristine || !AssetTemplateForm.dirty && !AssetTemplateForm.pristine"
                (click)="resetForm()" i18n="Reset button|Reset@@reset"> Reset
              </button>
              &nbsp;
              <span i18n-matTooltip="Tooltip validation|Fill the mandatory fields@@fillTheMandatoryFields"
                matTooltip="Fill the mandatory fields" [matTooltipDisabled]="AssetTemplateForm.valid">
                <a>
                  <button i18n="Review&Save button|Review&Save@@review&Save"
                    class="btn btn-primary text-center reviewAndSaveActionButton" type="submit"
                    [disabled]="!AssetTemplateForm.valid">
                    Review & Save</button>
                </a>
              </span>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<!--  Role forms view ends here -->

<!-- Global modal notification component selector for cancel and final save form-->
<app-modal-notification (modelNotificationWarning)="alertRedirection()" (modelNotificationDanger)="confirmDelete()">
</app-modal-notification>